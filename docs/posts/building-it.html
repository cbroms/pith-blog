<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/global.css"/><meta name="description" content="Much of the focus of the Pith blog has been about why we&#x27;re designing the system and what we&#x27;re considering while doing so. We&#x27;ve yet to discuss much about how we&#x27;re building Pith, specifically the technologies we&#x27;re using and architecture of the system."/><title>How we&#x27;re building it - Pith Blog</title><meta name="next-head-count" content="5"/><link rel="preload" href="/_next/static/bE5FR_0f6IZY4h8MbXmnQ/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/bE5FR_0f6IZY4h8MbXmnQ/pages/posts/%5Bid%5D.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-96199dcf2debb2c20139.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.e7654534a2179db58c67.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.c5a2f9d2693bf92041ea.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-7bf605771b6a03910722.js" as="script"/><link rel="preload" href="/_next/static/chunks/e36e7e5e11f6f786f35a85b52e84e3f95d7a8af3.1feafbd9154c47917911.js" as="script"/></head><body><div id="__next"><div><div><nav><div id="logo">Pith <span class="blog">Blog</span></div></nav><div class="post-wrapper"><h2 class="post-title large">How we&#x27;re building it</h2><time class="post-date" dateTime="2020-09-08">September 8, 2020</time><div class="post-author">Christian Broms and Sydney Zheng</div><div class="post-content"><p>Much of the focus of the Pith blog has been about <em>why</em> we're designing the system and what we're considering while doing so. We've yet to discuss much about <em>how</em> we're building Pith, specifically the technologies we're using and architecture of the system. This post will outline our current approach and rationale. </p>
<h2>The system architecture</h2>
<p>At the most basic level, Pith has two components: a web-based client interface and a server that handles coordinating multiple clients. </p>
<h3>Client</h3>
<p>We've opted for having the client handle the UI display logic as a standalone <a href="https://reactjs.org/">React</a> / <a href="https://redux.js.org/">Redux</a> project as opposed to server-rendered pages (such as with <a href="https://nextjs.org/">Next.js</a> or <a href="https://www.djangoproject.com/">Django</a>) because we want the server to be generalizable to different client implementations. We see the UI as a flexible and extensible component that sits on top of the core Pith structure and could take many different forms. The web app that we're designing could be extended, remixed, or completely replaced and Pith's core functionality would remain unchanged. </p>
<h3>Communication</h3>
<p>Given Pith is a place for realtime discussion, we needed to build the system a bit like <a href="https://en.wikipedia.org/wiki/Internet_Relay_Chat">IRC</a> with updates automatically pushed to the clients by the server. For websites, this functionality can be implemented using <a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API">websockets</a>. We're using the <a href="https://socket.io/">socket.io</a> library because it's easy to use and provides all the functionality we need with its <a href="https://socket.io/docs/rooms/">rooms</a> and <a href="https://socket.io/docs/namespaces/">namespaces</a>. </p>
<h3>Server</h3>
<p>Rather than use the official Node.js server library for <a href="http://socket.io">socket.io</a>, we have opted to use the community built and maintained <a href="https://python-socketio.readthedocs.io/en/latest/">python-socketio</a> library for two main reasons. First, we're more comfortable with Python as a language, and second, when it comes to implementing the network, reliable and well documented packages like <a href="https://www.nltk.org/">nltk</a>, <a href="https://networkx.github.io/">networkx</a>, and <a href="https://graph-tool.skewed.de/">graph-tool</a> will make development simpler than finding javascript equivalents. </p>
<p>The server is composed of a number of smaller services:</p>
<ul>
<li><code>app</code>: the socketio interface that's used by <a href="https://github.com/rainflame/pith-client">the React client</a>.</li>
<li><code>worker</code>: a worker script using the <a href="https://github.com/samuelcolvin/arq">arq task queue</a> for executing assorted long-term tasks such as archiving discussions when they're complete.</li>
<li><code>redis</code>: a Redis database used by the task queue (<code>worker</code>) and as a message queue by socketio (<code>app</code>).</li>
<li><code>mongo</code>: the MongoDB database used to store the discussion content.</li>
</ul>
<p>We use docker and docker compose for orchestrating building and running each of these services in containers. You can read more about this process in <a href="https://github.com/rainflame/pith-api/blob/master/README.md">the project's readme file</a>. </p>
<h3>Managers</h3>
<p>The <code>app</code> specifies the <a href="https://pith-api.readthedocs.io/en/latest/app.html">API</a> the frontend uses. However, the functions within <code>app</code> only handle the parsing and validation of requests and the proper return or emit of the response. The actual logic of the function is encapsulated in a managing-function called between request handling and response handling. These managing functions reside in manager classes. Currently, we have a manager for any logic surrounding the discussion abstraction. We are also planning on making a manager for logic surrounding the board abstraction and one for the user abstraction.</p>
</div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"building-it","contentHtml":"\u003cp\u003eMuch of the focus of the Pith blog has been about \u003cem\u003ewhy\u003c/em\u003e we're designing the system and what we're considering while doing so. We've yet to discuss much about \u003cem\u003ehow\u003c/em\u003e we're building Pith, specifically the technologies we're using and architecture of the system. This post will outline our current approach and rationale. \u003c/p\u003e\n\u003ch2\u003eThe system architecture\u003c/h2\u003e\n\u003cp\u003eAt the most basic level, Pith has two components: a web-based client interface and a server that handles coordinating multiple clients. \u003c/p\u003e\n\u003ch3\u003eClient\u003c/h3\u003e\n\u003cp\u003eWe've opted for having the client handle the UI display logic as a standalone \u003ca href=\"https://reactjs.org/\"\u003eReact\u003c/a\u003e / \u003ca href=\"https://redux.js.org/\"\u003eRedux\u003c/a\u003e project as opposed to server-rendered pages (such as with \u003ca href=\"https://nextjs.org/\"\u003eNext.js\u003c/a\u003e or \u003ca href=\"https://www.djangoproject.com/\"\u003eDjango\u003c/a\u003e) because we want the server to be generalizable to different client implementations. We see the UI as a flexible and extensible component that sits on top of the core Pith structure and could take many different forms. The web app that we're designing could be extended, remixed, or completely replaced and Pith's core functionality would remain unchanged. \u003c/p\u003e\n\u003ch3\u003eCommunication\u003c/h3\u003e\n\u003cp\u003eGiven Pith is a place for realtime discussion, we needed to build the system a bit like \u003ca href=\"https://en.wikipedia.org/wiki/Internet_Relay_Chat\"\u003eIRC\u003c/a\u003e with updates automatically pushed to the clients by the server. For websites, this functionality can be implemented using \u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API\"\u003ewebsockets\u003c/a\u003e. We're using the \u003ca href=\"https://socket.io/\"\u003esocket.io\u003c/a\u003e library because it's easy to use and provides all the functionality we need with its \u003ca href=\"https://socket.io/docs/rooms/\"\u003erooms\u003c/a\u003e and \u003ca href=\"https://socket.io/docs/namespaces/\"\u003enamespaces\u003c/a\u003e. \u003c/p\u003e\n\u003ch3\u003eServer\u003c/h3\u003e\n\u003cp\u003eRather than use the official Node.js server library for \u003ca href=\"http://socket.io\"\u003esocket.io\u003c/a\u003e, we have opted to use the community built and maintained \u003ca href=\"https://python-socketio.readthedocs.io/en/latest/\"\u003epython-socketio\u003c/a\u003e library for two main reasons. First, we're more comfortable with Python as a language, and second, when it comes to implementing the network, reliable and well documented packages like \u003ca href=\"https://www.nltk.org/\"\u003enltk\u003c/a\u003e, \u003ca href=\"https://networkx.github.io/\"\u003enetworkx\u003c/a\u003e, and \u003ca href=\"https://graph-tool.skewed.de/\"\u003egraph-tool\u003c/a\u003e will make development simpler than finding javascript equivalents. \u003c/p\u003e\n\u003cp\u003eThe server is composed of a number of smaller services:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eapp\u003c/code\u003e: the socketio interface that's used by \u003ca href=\"https://github.com/rainflame/pith-client\"\u003ethe React client\u003c/a\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eworker\u003c/code\u003e: a worker script using the \u003ca href=\"https://github.com/samuelcolvin/arq\"\u003earq task queue\u003c/a\u003e for executing assorted long-term tasks such as archiving discussions when they're complete.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eredis\u003c/code\u003e: a Redis database used by the task queue (\u003ccode\u003eworker\u003c/code\u003e) and as a message queue by socketio (\u003ccode\u003eapp\u003c/code\u003e).\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emongo\u003c/code\u003e: the MongoDB database used to store the discussion content.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eWe use docker and docker compose for orchestrating building and running each of these services in containers. You can read more about this process in \u003ca href=\"https://github.com/rainflame/pith-api/blob/master/README.md\"\u003ethe project's readme file\u003c/a\u003e. \u003c/p\u003e\n\u003ch3\u003eManagers\u003c/h3\u003e\n\u003cp\u003eThe \u003ccode\u003eapp\u003c/code\u003e specifies the \u003ca href=\"https://pith-api.readthedocs.io/en/latest/app.html\"\u003eAPI\u003c/a\u003e the frontend uses. However, the functions within \u003ccode\u003eapp\u003c/code\u003e only handle the parsing and validation of requests and the proper return or emit of the response. The actual logic of the function is encapsulated in a managing-function called between request handling and response handling. These managing functions reside in manager classes. Currently, we have a manager for any logic surrounding the discussion abstraction. We are also planning on making a manager for logic surrounding the board abstraction and one for the user abstraction.\u003c/p\u003e\n","title":"How we're building it","date":"2020-09-08","author":"Christian Broms and Sydney Zheng","summary":"Much of the focus of the Pith blog has been about why we're designing the system and what we're considering while doing so. We've yet to discuss much about how we're building Pith, specifically the technologies we're using and architecture of the system."}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"building-it"},"buildId":"bE5FR_0f6IZY4h8MbXmnQ","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/runtime/polyfills-b5792cb05b81d93fa5b1.js"></script><script async="" data-next-page="/_app" src="/_next/static/bE5FR_0f6IZY4h8MbXmnQ/pages/_app.js"></script><script async="" data-next-page="/posts/[id]" src="/_next/static/bE5FR_0f6IZY4h8MbXmnQ/pages/posts/%5Bid%5D.js"></script><script src="/_next/static/runtime/webpack-96199dcf2debb2c20139.js" async=""></script><script src="/_next/static/chunks/framework.e7654534a2179db58c67.js" async=""></script><script src="/_next/static/chunks/commons.c5a2f9d2693bf92041ea.js" async=""></script><script src="/_next/static/runtime/main-7bf605771b6a03910722.js" async=""></script><script src="/_next/static/chunks/e36e7e5e11f6f786f35a85b52e84e3f95d7a8af3.1feafbd9154c47917911.js" async=""></script><script src="/_next/static/bE5FR_0f6IZY4h8MbXmnQ/_buildManifest.js" async=""></script><script src="/_next/static/bE5FR_0f6IZY4h8MbXmnQ/_ssgManifest.js" async=""></script></body></html>